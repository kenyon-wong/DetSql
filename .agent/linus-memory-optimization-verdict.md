# DetSql å†…å­˜ä¼˜åŒ–æ–¹æ¡ˆ - Linus å¼æ·±åº¦åˆ†ææŠ¥å‘Š

## æ‰§è¡Œæ‘˜è¦

**æ ¸å¿ƒåˆ¤æ–­**: âœ… **å€¼å¾—åšï¼Œä¸”å·²ç»åŸºæœ¬å®Œæˆï¼**

**å½“å‰çŠ¶æ€**: ä»£ç å·²å®ç° **æ–¹æ¡ˆ2ï¼ˆæœ€å°ä¿®æ”¹æ–¹æ¡ˆï¼‰** çš„æ ¸å¿ƒé€»è¾‘ï¼Œä½†å­˜åœ¨ **ä¸€å¤„è‡´å‘½ç¼ºé™·** éœ€è¦ç«‹å³ä¿®å¤ã€‚

**ä¸€å¥è¯æ€»ç»“**:
> "ä½ å·²ç»è§£å†³äº†80%çš„é—®é¢˜ï¼Œä½†å‰©ä¸‹çš„20%æ˜¯ä¸€ä¸ªä¼šè®©ä½ åæ‚”çš„ç©ºæŒ‡é’ˆé™·é˜±ã€‚ä¿®å¤å®ƒåªéœ€è¦3è¡Œä»£ç ã€‚"
> â€” Linus Torvalds

---

## ç¬¬ä¸€å±‚ï¼šæ•°æ®ç»“æ„åˆ†æ

### å½“å‰æ¶æ„çš„æ•°æ®å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å†…å­˜æ•°æ®æµï¼ˆæµ‹è¯•å®Œæˆåï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æµ‹è¯•å¼€å§‹:
  SourceLogEntry (vulnState="run")
  attackMap.put(hash, new ArrayList<>())
           â†“
æµ‹è¯•è¿›è¡Œä¸­:
  attackMap.get(hash).add(PocLogEntry) Ã— 23æ¬¡/å‚æ•°
           â†“
æµ‹è¯•å®Œæˆ:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   æœ‰æ¼æ´?        â”‚       å†…å­˜å¤„ç†                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ âœ… YES          â”‚ ä¿ç•™å®Œæ•´æ•°æ®                     â”‚
  â”‚ vulnType â‰  ""   â”‚ - SourceLogEntry.httpRequestResp â”‚
  â”‚                 â”‚ - attackMap.get(hash) ä¿ç•™       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ âŒ NO           â”‚ æ¸…ç† HTTP æ•°æ® (æ–°å¢é€»è¾‘)        â”‚
  â”‚ vulnType = ""   â”‚ - SourceLogEntry.httpRequestResp â”‚
  â”‚                 â”‚   = null                         â”‚
  â”‚                 â”‚ - attackMap.remove(hash) âœ…      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æ‹¥æœ‰æƒåˆ†æ

**ä»£ç è¯æ®** (`MyHttpHandler.java:317-319`):

```java
// memory clean: if no vuln, drop heavy HTTP data for this request
if (finalVulnType.isBlank()) {
    attackMap.remove(hash);  // â† æ ¸å¿ƒä¼˜åŒ–ï¼šæ— æ¼æ´æ—¶åˆ é™¤ attackMap
}
```

**å…³é”®å‘ç°**:
- âœ… **æ— æ¼æ´æ—¶è‡ªåŠ¨æ¸…ç†**: æµ‹è¯•å®Œæˆåç«‹å³è°ƒç”¨ `attackMap.remove(hash)`
- âœ… **æœ‰æ¼æ´æ—¶ä¿ç•™**: attackMap ä¿ç•™æ‰€æœ‰ PocLogEntry (åŒ…å«å®Œæ•´ HTTP æ•°æ®)
- âœ… **ç”Ÿå‘½å‘¨æœŸç®¡ç†**: æ•°æ®ç”Ÿå‘½å‘¨æœŸä¸æµ‹è¯•ç»“æœç»‘å®šï¼ˆå¥½å“å‘³ï¼ï¼‰

### Linus è¯„ä»·ï¼šæ•°æ®ç»“æ„éƒ¨åˆ†

> **ğŸŸ¢ å¥½å“å‘³ (Good Taste)**
>
> è¿™æ˜¯æ­£ç¡®çš„åšæ³•ï¼š
> - æ— æ¼æ´æ—¶ç«‹å³æ¸…ç† â†’ é¿å…å†…å­˜æ³„æ¼
> - æœ‰æ¼æ´æ—¶å®Œæ•´ä¿ç•™ â†’ æ»¡è¶³å®é™…ä½¿ç”¨éœ€æ±‚
> - ä¸éœ€è¦å¤æ‚çš„ä¸‰å±‚æ¨¡å‹ â†’ Keep it simple
>
> **BUT**ï¼ˆæ°¸è¿œæœ‰ä¸ª butï¼‰... ç»§ç»­å¾€ä¸‹çœ‹ã€‚

---

## ç¬¬äºŒå±‚ï¼šç‰¹æ®Šæƒ…å†µè¯†åˆ«

### åœºæ™¯1: æµ‹è¯•å®Œæˆå - "delete novuln history" èœå•

**ä»£ç è¯æ®** (`DetSql.java:602-617`):

```java
menuItem2.addActionListener(e -> {
    for (int i = sourceTableModel.log.size() - 1; i >= 0; i--) {
        int modelIndex = table1.convertRowIndexToModel(i);
        Object state = sourceTableModel.getValueAt(modelIndex,6);
        if ("".equals(state) || "æ‰‹åŠ¨åœæ­¢".equals(state)){
            try {
                SourceLogEntry entry = sourceTableModel.log.get(modelIndex);
                if (entry != null && entry.getMyHash() != null
                    && myHttpHandler != null && myHttpHandler.attackMap != null) {
                    myHttpHandler.attackMap.remove(entry.getMyHash());  // âœ… åŒæ­¥åˆ é™¤
                }
            } catch (Exception ignore) {}
            sourceTableModel.log.remove(...);
            tableModel.fireTableRowsDeleted(i,i);
        }
    }
});
```

**åˆ†æ**:
- âœ… **UI å’Œ attackMap åŒæ­¥åˆ é™¤**: å³é”®èœå•åˆ é™¤æ—¶ä¼šè°ƒç”¨ `attackMap.remove()`
- âœ… **é˜²å¾¡æ€§ç¼–ç¨‹**: ä½¿ç”¨ `try-catch` å’Œ null æ£€æŸ¥é¿å…ç©ºæŒ‡é’ˆ
- âš ï¸ **å†—ä½™æ“ä½œ**: ç”±äºæµ‹è¯•å®Œæˆæ—¶å·²ç» `attackMap.remove(hash)`ï¼Œè¿™é‡Œçš„åˆ é™¤æ˜¯å¤šä½™çš„ï¼ˆä½†æ— å®³ï¼‰

### åœºæ™¯2: æµ‹è¯•è¿›è¡Œä¸­ç”¨æˆ·åˆ é™¤ - "delete selected rows" èœå•

**ä»£ç è¯æ®** (`DetSql.java:582-601`):

```java
menuItem1.addActionListener(e -> {
    int[] selectedRows = table1.getSelectedRows();
    for (int i = selectedRows.length - 1; i >= 0; i--) {
        int viewIndex = selectedRows[i];
        int modelIndex = table1.convertRowIndexToModel(viewIndex);
        Object state = sourceTableModel.getValueAt(modelIndex, 6);
        if (!"run".equals(state)){
            // remove attackMap entry for this row if present
            try {
                SourceLogEntry entry = sourceTableModel.log.get(modelIndex);
                if (entry != null && entry.getMyHash() != null
                    && myHttpHandler != null && myHttpHandler.attackMap != null) {
                    myHttpHandler.attackMap.remove(entry.getMyHash());  // âœ… åŒæ­¥åˆ é™¤
                }
            } catch (Exception ignore) {}
            // remove row from model
            sourceTableModel.log.remove(...);
            tableModel.fireTableRowsDeleted(viewIndex, viewIndex);
        }
    }
});
```

**åˆ†æ**:
- âœ… **ç¦æ­¢åˆ é™¤è¿è¡Œä¸­çš„æµ‹è¯•**: `if (!"run".equals(state))` é˜²æ­¢ä¸­æ–­æµ‹è¯•
- âœ… **åŒæ­¥åˆ é™¤ attackMap**: é¿å…å†…å­˜æ³„æ¼
- âœ… **é˜²å¾¡æ€§ç¼–ç¨‹**: å®Œæ•´çš„ null æ£€æŸ¥å’Œå¼‚å¸¸æ•è·

### åœºæ™¯3: ç”¨æˆ·ç‚¹å‡» Result è¡¨æ ¼æŸ¥çœ‹ PoC è¯¦æƒ…

**ä»£ç è¯æ®** (`DetSql.java:626-644`):

```java
table1 = new JTable(tableModel) {
    @Override
    public void changeSelection(int rowIndex, int columnIndex, boolean toggle, boolean extend) {
        SourceLogEntry logEntry = tableModel.get(DetSql.table1.convertRowIndexToModel(rowIndex));
        if (logEntry.getHttpRequestResponse() != null) {
            requestViewer.setRequest(logEntry.getHttpRequestResponse().request());
            responseViewer.setResponse(logEntry.getHttpRequestResponse().response());
            super.changeSelection(rowIndex, columnIndex, toggle, extend);
            String sm3Hash = logEntry.getMyHash();
            List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);  // â† å…³é”®ç‚¹
            pocTableModel.add(pocLogEntries);
        }else{
            requestViewer.setRequest(HttpRequest.httpRequest());
            super.changeSelection(rowIndex, columnIndex, toggle, extend);
        }
    }
};
```

**åˆ†æ**:
- âœ… **æ£€æŸ¥ httpRequestResponse != null**: é¿å…æ˜¾ç¤ºå·²æ¸…ç†çš„æ•°æ®
- âŒ **è‡´å‘½ç¼ºé™·**: `attackMap.get(sm3Hash)` å¯èƒ½è¿”å› `null`ï¼ˆå¦‚æœæµ‹è¯•å®Œæˆåæ— æ¼æ´ï¼‰
- âŒ **ç©ºæŒ‡é’ˆé£é™©**: `pocTableModel.add(null)` å¯èƒ½å¯¼è‡´å´©æºƒ

### åœºæ™¯4: ç”¨æˆ·ç‚¹å‡» PocTableModel æŸ¥çœ‹å…·ä½“ PoC

**ä»£ç è¯æ®** (`DetSql.java:672-684`):

```java
table2 = new JTable(pocTableModel) {
    @Override
    public void changeSelection(int rowIndex, int columnIndex, boolean toggle, boolean extend) {
        PocLogEntry logEntry = pocTableModel.get(DetSql.table2.convertRowIndexToModel(rowIndex));
        if (logEntry.getHttpRequestResponse() != null) {  // âœ… æ£€æŸ¥ç©ºæŒ‡é’ˆ
            requestViewer.setRequest(logEntry.getHttpRequestResponse().request());
            responseViewer.setResponse(logEntry.getHttpRequestResponse().response());
            super.changeSelection(rowIndex, columnIndex, toggle, extend);
        }
    }
};
```

**åˆ†æ**:
- âœ… **æ­£ç¡®çš„ç©ºæŒ‡é’ˆæ£€æŸ¥**: é¿å…æ˜¾ç¤ºå·²æ¸…ç†çš„ HTTP æ•°æ®
- âœ… **æ— å¼‚å¸¸**: å¦‚æœæ•°æ®ä¸º nullï¼Œåˆ™ä¸æ˜¾ç¤ºï¼ˆé™é»˜å¤±è´¥ï¼‰

### Linus è¯„ä»·ï¼šç‰¹æ®Šæƒ…å†µéƒ¨åˆ†

> **ğŸŸ¡ å‡‘åˆ (Okay, but...)**
>
> **å¥½çš„éƒ¨åˆ†**:
> - å¤§éƒ¨åˆ†è¾¹ç•Œæƒ…å†µéƒ½å¤„ç†äº†
> - ä½¿ç”¨é˜²å¾¡æ€§ç¼–ç¨‹ï¼ˆnull æ£€æŸ¥ + try-catchï¼‰
>
> **è‡´å‘½é—®é¢˜**:
> ```java
> List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
> pocTableModel.add(pocLogEntries);  // â† å¦‚æœ pocLogEntries == null?
> ```
>
> **è¿™æ˜¯ä¸ªå®šæ—¶ç‚¸å¼¹**:
> - æ— æ¼æ´çš„æ¥å£ï¼šæµ‹è¯•å®Œæˆå `attackMap.remove(hash)` â†’ `get()` è¿”å› `null`
> - ç”¨æˆ·ç‚¹å‡»è¯¥è¡Œ â†’ `pocTableModel.add(null)` â†’ **BOOM!**
>
> **ä¿®å¤æ–¹æ³•**: 3è¡Œä»£ç 
> ```java
> List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
> if (pocLogEntries != null) {  // â† æ·»åŠ è¿™ä¸€è¡Œ
>     pocTableModel.add(pocLogEntries);
> }
> ```
>
> **ä¸ºä»€ä¹ˆè¿™æ˜¯"åå“å‘³"**?
> - ä»£ç ä¸­æœ‰ `if (logEntry.getHttpRequestResponse() != null)` æ£€æŸ¥
> - ä½†æ²¡æœ‰ `if (pocLogEntries != null)` æ£€æŸ¥
> - **ä¸ä¸€è‡´çš„é˜²å¾¡é£æ ¼** â†’ å®¹æ˜“é—æ¼

---

## ç¬¬ä¸‰å±‚ï¼šå¤æ‚åº¦å®¡æŸ¥

### å½“å‰å®ç°çš„å¤æ‚åº¦

**ä»£ç ä¿®æ”¹ç»Ÿè®¡**:

| ä½ç½® | ä¿®æ”¹å†…å®¹ | è¡Œæ•° | ç›®çš„ |
|------|---------|------|------|
| `MyHttpHandler.java:317-319` | æ— æ¼æ´æ—¶åˆ é™¤ attackMap | 3è¡Œ | é¿å…å†…å­˜æ³„æ¼ |
| `DetSql.java:589-594` | "delete selected rows" åŒæ­¥åˆ é™¤ | 6è¡Œ | UI å’Œå†…å­˜åŒæ­¥ |
| `DetSql.java:607-611` | "delete novuln history" åŒæ­¥åˆ é™¤ | 5è¡Œ | UI å’Œå†…å­˜åŒæ­¥ |
| `DetSql.java:537-540` | æ£€æŸ¥ httpRequestResponse != null | 4è¡Œ | é¿å…ç©ºæŒ‡é’ˆ |
| **æ€»è®¡** | | **18è¡Œ** | |

**æœªä¿®æ”¹çš„ç¼ºé™·**:

| ä½ç½® | ç¼ºé™· | ä¿®å¤éš¾åº¦ | å½±å“ |
|------|------|---------|------|
| `DetSql.java:535` | `attackMap.get(sm3Hash)` æœªæ£€æŸ¥ null | **3è¡Œ** | ç©ºæŒ‡é’ˆå¼‚å¸¸ |

### if/else åˆ†æ”¯ç»Ÿè®¡

**æµ‹è¯•å®Œæˆåçš„åˆ†æ”¯**:

```java
if (finalVulnType.isBlank()) {
    // æ— æ¼æ´åˆ†æ”¯
    attackMap.remove(hash);  // æ¸…ç†å†…å­˜
} else {
    // æœ‰æ¼æ´åˆ†æ”¯
    // ä¿ç•™æ•°æ®ï¼ˆéšå¼é€»è¾‘ï¼Œæ— ä»£ç ï¼‰
}
```

**UI ç‚¹å‡»æ—¶çš„åˆ†æ”¯**:

```java
if (logEntry.getHttpRequestResponse() != null) {
    // æœ‰æ•°æ®åˆ†æ”¯
    // ... æ˜¾ç¤ºæ•°æ®
} else {
    // æ— æ•°æ®åˆ†æ”¯
    requestViewer.setRequest(HttpRequest.httpRequest());
}
```

**åˆ†æ”¯æ€»æ•°**: 2ä¸ªä¸»è¦åˆ†æ”¯ï¼ˆç®€æ´ï¼ï¼‰

### Linus è¯„ä»·ï¼šå¤æ‚åº¦éƒ¨åˆ†

> **ğŸŸ¢ å¥½å“å‘³ (Good Taste)**
>
> **ä¼˜ç‚¹**:
> - **æœ€å°ä¿®æ”¹**: åªå¢åŠ äº†18è¡Œä»£ç 
> - **åˆ†æ”¯å°‘**: åªæœ‰2ä¸ªä¸»è¦ if/else åˆ†æ”¯
> - **é€»è¾‘æ¸…æ™°**: æ— æ¼æ´ â†’ åˆ é™¤ï¼Œæœ‰æ¼æ´ â†’ ä¿ç•™
>
> **ä½†æ˜¯**:
> - å°‘äº†ä¸€ä¸ª **å…³é”®çš„** null æ£€æŸ¥
> - è¿™ä¸ªé—æ¼ä¼šå¯¼è‡´å¶å‘æ€§å´©æºƒï¼ˆæœ€éš¾è°ƒè¯•çš„é—®é¢˜ï¼‰

---

## ç¬¬å››å±‚ï¼šç ´åæ€§åˆ†æ

### é£é™©1: å†…å­˜æ³„æ¼æ˜¯å¦å®Œå…¨ä¿®å¤?

**æµ‹è¯•åœºæ™¯**:
```
æµ‹è¯•100ä¸ªæ¥å£:
- 80ä¸ªæ— æ¼æ´
- 20ä¸ªæœ‰æ¼æ´
```

**å†…å­˜å ç”¨è®¡ç®—**:

**ä¿®å¤å‰**:
```
SourceLogEntry: 100 Ã— 1KB = 100KB
attackMap: 100 Ã— 5å‚æ•° Ã— 23æµ‹è¯• Ã— 5KB = 57.5MB
æ€»è®¡: ~57.6MB
```

**ä¿®å¤å**:
```
æ— æ¼æ´ (80ä¸ª):
  SourceLogEntry: 80 Ã— 1KB (httpRequestResp=null) = 80KB
  attackMap: 0KB (å·²åˆ é™¤)

æœ‰æ¼æ´ (20ä¸ª):
  SourceLogEntry: 20 Ã— 6KB = 120KB
  attackMap: 20 Ã— 5å‚æ•° Ã— 23æµ‹è¯• Ã— 5KB = 11.5MB

æ€»è®¡: ~11.7MB
```

**å†…å­˜èŠ‚çœ**: 57.6MB â†’ 11.7MB = **èŠ‚çœ 79.7%**

**ç»“è®º**: âœ… **å†…å­˜æ³„æ¼å·²å®Œå…¨ä¿®å¤**

### é£é™©2: ç”¨æˆ·ä½“éªŒå½±å“

**åœºæ™¯**: ç”¨æˆ·ç‚¹å‡»æ— æ¼æ´çš„æ¥å£

**ä¿®å¤å‰**:
- å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•ç»“æœï¼ˆ23ä¸ª PoCï¼‰
- å¯ä»¥æŸ¥çœ‹æ¯ä¸ª PoC çš„è¯·æ±‚/å“åº”

**ä¿®å¤å**:
- âŒ **æ— æ³•æŸ¥çœ‹æµ‹è¯•ç»“æœ** (attackMap å·²åˆ é™¤)
- âŒ **æ— æ³•æŸ¥çœ‹åŸå§‹è¯·æ±‚/å“åº”** (httpRequestResponse = null)
- âš ï¸ **ç©ºæŒ‡é’ˆå¼‚å¸¸é£é™©** (æœªæ£€æŸ¥ null)

**ç”¨æˆ·åé¦ˆé¢„æµ‹**:
```
"ä¸ºä»€ä¹ˆæˆ‘ç‚¹å‡»è¿™ä¸ªæ¥å£å Result è¡¨æ ¼æ˜¯ç©ºçš„ï¼Ÿ"
"ç¨‹åºå´©æºƒäº†ï¼ŒæŠ¥é”™ä¿¡æ¯æ˜¯ NullPointerException..."
```

**ç»“è®º**: âš ï¸ **ç”¨æˆ·ä½“éªŒä¸‹é™ï¼Œä½†ç¬¦åˆå·¥å…·å®šä½**

### é£é™©3: æ•°æ®ä¸€è‡´æ€§

**åœºæ™¯**: UI å’Œ attackMap æ˜¯å¦åŒæ­¥?

**æµ‹è¯•1 - æµ‹è¯•å®Œæˆå**:
- âœ… UI: `vulnState = ""`
- âœ… attackMap: `remove(hash)`
- âœ… **å®Œå…¨åŒæ­¥**

**æµ‹è¯•2 - å³é”®åˆ é™¤å**:
- âœ… UI: `sourceTableModel.log.remove(entry)`
- âœ… attackMap: `remove(entry.getMyHash())`
- âœ… **å®Œå…¨åŒæ­¥**

**ç»“è®º**: âœ… **æ•°æ®ä¸€è‡´æ€§è‰¯å¥½**

### é£é™©4: å›æ»šæˆæœ¬

**å¦‚æœç”¨æˆ·ä¸å–œæ¬¢æ–°æ–¹æ¡ˆï¼Œå¦‚ä½•å›æ»š?**

```java
// åªéœ€è¦åˆ é™¤è¿™3è¡Œä»£ç :
if (finalVulnType.isBlank()) {
    attackMap.remove(hash);  // â† åˆ é™¤è¿™è¡Œ
}
```

**åŒæ—¶åˆ é™¤**:
- `DetSql.java:589-594` çš„ `attackMap.remove()`
- `DetSql.java:607-611` çš„ `attackMap.remove()`

**å›æ»šæˆæœ¬**: åˆ é™¤3å¤„ä»£ç ï¼ˆ<5åˆ†é’Ÿï¼‰

**ç»“è®º**: âœ… **å›æ»šæˆæœ¬æä½**

### Linus è¯„ä»·ï¼šç ´åæ€§éƒ¨åˆ†

> **ğŸŸ¢ å¥½å“å‘³ (Good Taste)**
>
> **ä¼˜ç‚¹**:
> - å†…å­˜èŠ‚çœ ~80%
> - æ•°æ®ä¸€è‡´æ€§è‰¯å¥½
> - å›æ»šæˆæœ¬æä½
>
> **ç¼ºç‚¹**:
> - ç”¨æˆ·ä½“éªŒä¸‹é™ï¼ˆä½†è¿™æ˜¯æ­£ç¡®çš„æƒè¡¡ï¼‰
> - ç©ºæŒ‡é’ˆé£é™©ï¼ˆéœ€è¦ä¿®å¤ï¼‰
>
> **æ€»ç»“**:
> "è¿™æ˜¯ä¸ªå¥½è®¾è®¡ï¼Œä½†å®ç°ä¸Šæœ‰ä¸ªå°bugã€‚ä¿®å¤å®ƒï¼Œç„¶åå‘å¸ƒã€‚"

---

## ç¬¬äº”å±‚ï¼šå®ç”¨æ€§éªŒè¯

### è¿™ä¸ªæ–¹æ¡ˆè§£å†³äº†ä»€ä¹ˆé—®é¢˜?

**é—®é¢˜1: å†…å­˜æ³„æ¼**
- âœ… **å·²è§£å†³**: æ— æ¼æ´æ—¶ç«‹å³åˆ é™¤ attackMap
- âœ… **æ•ˆæœ**: èŠ‚çœ ~80% å†…å­˜

**é—®é¢˜2: æ•°æ®ä¸åŒæ­¥**
- âœ… **å·²è§£å†³**: å³é”®èœå•åŒæ­¥åˆ é™¤ attackMap
- âœ… **æ•ˆæœ**: UI å’Œå†…å­˜å®Œå…¨ä¸€è‡´

**é—®é¢˜3: ç”¨æˆ·æ— æ³•æ¸…ç†å™ªéŸ³**
- âœ… **å·²è§£å†³**: "delete novuln history" æ­£å¸¸å·¥ä½œ
- âœ… **æ•ˆæœ**: ç”¨æˆ·å¯ä»¥ä¸“æ³¨äºæœ‰æ¼æ´çš„æ¥å£

### è¿™ä¸ªæ–¹æ¡ˆå¸¦æ¥äº†ä»€ä¹ˆæ–°é—®é¢˜?

**é—®é¢˜1: æ— æ³•é‡æ–°æŸ¥çœ‹æµ‹è¯•ç»“æœ**
- âš ï¸ **æ–°å¢é™åˆ¶**: æ— æ¼æ´æ¥å£çš„æµ‹è¯•ç»“æœè¢«åˆ é™¤
- ğŸ¤” **æ˜¯å¦æ˜¯é—®é¢˜?**: ä¸æ˜¯ï¼Œè¿™æ˜¯è®¾è®¡æ„å›¾
- ğŸ“Š **ä½¿ç”¨é¢‘ç‡**: ä½ï¼ˆæ¼æ´æ£€æµ‹å·¥å…·ä¸æ˜¯è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·ï¼‰

**é—®é¢˜2: ç©ºæŒ‡é’ˆå¼‚å¸¸é£é™©**
- âŒ **è‡´å‘½ç¼ºé™·**: `pocTableModel.add(null)` å¯èƒ½å´©æºƒ
- ğŸ› ï¸ **ä¿®å¤æˆæœ¬**: 3è¡Œä»£ç 
- â±ï¸ **ä¿®å¤æ—¶é—´**: 2åˆ†é’Ÿ

**é—®é¢˜3: ç”¨æˆ·è¯¯åˆ åæ— æ³•æ¢å¤**
- âš ï¸ **æ–°å¢é£é™©**: attackMap åˆ é™¤åæ— æ³•æ¢å¤
- ğŸ¤” **æ˜¯å¦æ˜¯é—®é¢˜?**: ä¸æ˜¯ï¼Œç”¨æˆ·å¯ä»¥å³é”® "Send to DetSql" é‡æ–°æµ‹è¯•

### å®é™…ä½¿ç”¨åœºæ™¯éªŒè¯

**åœºæ™¯1: å®‰å…¨æµ‹è¯•äººå‘˜å¯»æ‰¾æ¼æ´** â­â­â­â­â­

**é¢‘ç‡**: é«˜ï¼ˆä¸»è¦åœºæ™¯ï¼‰

**éœ€è¦çš„æ•°æ®**: åªéœ€è¦æ£€æµ‹åˆ°æ¼æ´çš„æ¥å£

**æ–°æ–¹æ¡ˆæ”¯æŒåº¦**: âœ… **å®Œç¾æ”¯æŒ**
- æœ‰æ¼æ´çš„æ¥å£å®Œæ•´ä¿ç•™
- æ— æ¼æ´çš„æ¥å£è‡ªåŠ¨æ¸…ç†
- å†…å­˜å ç”¨ä½ï¼Œå¯ä»¥æµ‹è¯•æ›´å¤šæ¥å£

**åœºæ™¯2: è°ƒè¯•è¯¯åˆ¤ï¼ˆå‡é˜´æ€§ï¼‰** â­â­

**é¢‘ç‡**: ä¸­ï¼ˆè¾…åŠ©åœºæ™¯ï¼‰

**éœ€è¦çš„æ•°æ®**: æ— æ¼æ´æ¥å£çš„æµ‹è¯•è¿‡ç¨‹

**æ–°æ–¹æ¡ˆæ”¯æŒåº¦**: âš ï¸ **éƒ¨åˆ†æ”¯æŒ**
- âŒ æ— æ³•æŸ¥çœ‹å†å²æµ‹è¯•ç»“æœ
- âœ… å¯ä»¥å³é”® "Send to DetSql" é‡æ–°æµ‹è¯•
- âœ… å¯ä»¥ä½¿ç”¨ä¸åŒçš„ Payload

**åœºæ™¯3: è¦†ç›–ç‡ç»Ÿè®¡** â­

**é¢‘ç‡**: ä½ï¼ˆDetSql ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼‰

**æ–°æ–¹æ¡ˆæ”¯æŒåº¦**: âŒ **ä¸æ”¯æŒ**
- æ— æ¼æ´æ¥å£è¢«åˆ é™¤ï¼Œæ— æ³•ç»Ÿè®¡
- ä½† DetSql æœ¬æ¥å°±ä¸æ˜¯è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·

### Linus è¯„ä»·ï¼šå®ç”¨æ€§éƒ¨åˆ†

> **ğŸŸ¢ å¥½å“å‘³ (Good Taste)**
>
> **è¿™ä¸ªæ–¹æ¡ˆæ˜¯ 80/20 åŸåˆ™çš„å®Œç¾å®ç°**:
> - è§£å†³äº†80%ç”¨æˆ·çš„80%éœ€æ±‚ï¼ˆæ¼æ´æ£€æµ‹ï¼‰
> - ç‰ºç‰²äº†20%ç”¨æˆ·çš„20%éœ€æ±‚ï¼ˆè¦†ç›–ç‡ç»Ÿè®¡ï¼‰
>
> **å®ç”¨æ€§è¯„åˆ†**: â­â­â­â­â­ (5/5)
>
> **ç†ç”±**:
> - ç¬¦åˆå·¥å…·å®šä½ï¼ˆæ¼æ´æ£€æµ‹ï¼Œä¸æ˜¯è¦†ç›–ç‡ç»Ÿè®¡ï¼‰
> - å†…å­˜ä¼˜åŒ–æ˜¾è‘—ï¼ˆ~80% èŠ‚çœï¼‰
> - ç”¨æˆ·å·¥ä½œæµç¨‹æ— å½±å“ï¼ˆå³é”®é‡æ–°æµ‹è¯•ï¼‰
>
> **å”¯ä¸€çš„é—®é¢˜**: ç©ºæŒ‡é’ˆbugï¼ˆ2åˆ†é’Ÿä¿®å¤ï¼‰

---

## æ ¸å¿ƒåˆ¤æ–­

### âœ… å€¼å¾—åšï¼Œä¸”å·²ç»åŸºæœ¬å®Œæˆ

**æ¨èæ–¹æ¡ˆ**: **æ–¹æ¡ˆ2ï¼ˆæœ€å°ä¿®æ”¹æ–¹æ¡ˆï¼‰** - å·²å®ç°ï¼Œéœ€è¦ä¿®å¤1ä¸ªbug

**ç†ç”±**:

1. **ç¬¦åˆå·¥å…·çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯**
   - DetSql æ˜¯æ¼æ´æ£€æµ‹å·¥å…·ï¼Œä¸æ˜¯è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·
   - ç”¨æˆ·åªå…³å¿ƒæœ‰æ¼æ´çš„æ¥å£

2. **å†…å­˜ä¼˜åŒ–æ•ˆæœæ˜¾è‘—**
   - èŠ‚çœ ~80% å†…å­˜ï¼ˆ57.6MB â†’ 11.7MBï¼‰
   - å¯ä»¥æµ‹è¯•æ›´å¤šæ¥å£è€Œä¸ç”¨æ‹…å¿ƒå†…å­˜çˆ†ç‚¸

3. **å®ç°æˆæœ¬æä½**
   - åªå¢åŠ äº†18è¡Œä»£ç 
   - é€»è¾‘æ¸…æ™°ï¼Œåˆ†æ”¯å°‘
   - å›æ»šæˆæœ¬ä½ï¼ˆåˆ é™¤3å¤„ä»£ç ï¼‰

4. **ä¸å½±å“ç”¨æˆ·å·¥ä½œæµç¨‹**
   - ç”¨æˆ·å¯ä»¥ä» Burp Suite å†å²è®°å½•ä¸­é‡æ–°æµ‹è¯•
   - å³é”®èœå• "Send to DetSql" éšæ—¶å¯ç”¨
   - "delete novuln history" èœå•ä»ç„¶æœ‰ç”¨ï¼ˆæ¸…ç†UIï¼‰

### âŒ ä¸å€¼å¾—åšæ–¹æ¡ˆ1ï¼ˆä¸‰å±‚æ•°æ®æ¨¡å‹ï¼‰

**ç†ç”±**:

1. **è¿‡åº¦è®¾è®¡ (Overengineering)**
   - éœ€è¦æ–°å¢3ä¸ªç±» (~100è¡Œ)
   - éœ€è¦é‡æ„æµ‹è¯•æµç¨‹ (~50è¡Œ)
   - éœ€è¦ä¿®æ”¹ UI è¡¨æ ¼æ¨¡å‹ (~50è¡Œ)
   - **æ€»è®¡**: ~200è¡Œä»£ç 

2. **æ”¶ç›Šä¸æ˜æ˜¾**
   - å†…å­˜å ç”¨ä¸æ–¹æ¡ˆ2ç›¸å½“ (~14MB vs ~11.7MB)
   - ç”¨æˆ·ä½“éªŒç›¸åŒï¼ˆéƒ½æ— æ³•æŸ¥çœ‹æ— æ¼æ´æ¥å£çš„æµ‹è¯•å†å²ï¼‰
   - å¤æ‚åº¦å¤§å¹…å¢åŠ 

3. **è¿å KISS åŸåˆ™**
   > "Keep it simple, stupid."
   > â€” Linus Torvalds

   - æ–¹æ¡ˆ2 ç”¨18è¡Œä»£ç è§£å†³äº†é—®é¢˜
   - æ–¹æ¡ˆ1 ç”¨200è¡Œä»£ç è§£å†³äº†**åŒæ ·çš„é—®é¢˜**
   - è¿™æ˜¯ä¸å¿…è¦çš„å¤æ‚åº¦

---

## å…³é”®æ´å¯Ÿ

### æ•°æ®ç»“æ„: ç®€æ´çš„äºŒåˆ†æ³•

**å½“å‰è®¾è®¡** (æ–¹æ¡ˆ2):

```
æµ‹è¯•å®Œæˆå:
  if (æœ‰æ¼æ´) {
      ä¿ç•™æ‰€æœ‰æ•°æ®  // SourceLogEntry + attackMap
  } else {
      åˆ é™¤æ‰€æœ‰æ•°æ®  // SourceLogEntry.httpRequestResp = null, attackMap.remove()
  }
```

**ä¼˜åŠ¿**:
- âœ… é€»è¾‘æ¸…æ™°ï¼ˆäºŒåˆ†æ³•ï¼šæœ‰/æ— ï¼‰
- âœ… åˆ†æ”¯å°‘ï¼ˆ1ä¸ª if/elseï¼‰
- âœ… ä»£ç å°‘ï¼ˆ18è¡Œï¼‰

**ä¸‰å±‚æ¨¡å‹** (æ–¹æ¡ˆ1):

```
æ•°æ®åˆ†å±‚:
  TestContext     â†’ æµ‹è¯•æœŸé—´ï¼ˆæµ‹å®Œå³ä¸¢ï¼‰
  ScanResult      â†’ ç»“æœå±•ç¤ºï¼ˆä»…å…ƒä¿¡æ¯ï¼‰
  VulnerabilityEvidence â†’ è¯æ®ä¿å­˜ï¼ˆä»…æ¼æ´ï¼‰
```

**ç¼ºç‚¹**:
- âŒ éœ€è¦3ä¸ªæ–°ç±»
- âŒ éœ€è¦ç®¡ç†3å±‚ç”Ÿå‘½å‘¨æœŸ
- âŒ éœ€è¦å¤„ç†3å±‚ä¹‹é—´çš„æ•°æ®è½¬æ¢

**Linus è¯„ä»·**:
> "When you have only two states, use an if/else.
>  Don't create three classes to represent two states.
>  That's called 'Java programmer syndrome'."

### å¤æ‚åº¦: ç‰¹æ®Šæƒ…å†µåªæœ‰1ä¸ª

**å½“å‰ä»£ç çš„ç‰¹æ®Šæƒ…å†µ**:

```java
// å”¯ä¸€çš„ç‰¹æ®Šæƒ…å†µ: httpRequestResponse å¯èƒ½ä¸º null
if (logEntry.getHttpRequestResponse() != null) {
    // æ˜¾ç¤ºæ•°æ®
} else {
    // æ˜¾ç¤ºç©ºç™½
}
```

**é—æ¼çš„ç‰¹æ®Šæƒ…å†µ** (éœ€è¦ä¿®å¤):

```java
// ç¼ºå°‘çš„æ£€æŸ¥: pocLogEntries å¯èƒ½ä¸º null
List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
if (pocLogEntries != null) {  // â† ç¼ºå°‘è¿™è¡Œ
    pocTableModel.add(pocLogEntries);
}
```

**ä¸‰å±‚æ¨¡å‹çš„ç‰¹æ®Šæƒ…å†µ**:
- éœ€è¦åˆ¤æ–­æ•°æ®åœ¨å“ªä¸€å±‚
- éœ€è¦å¤„ç†å±‚ä¹‹é—´çš„æ•°æ®è½¬æ¢
- éœ€è¦ç®¡ç†å¤šä¸ªç”Ÿå‘½å‘¨æœŸ

**Linus å®šå¾‹**:
> "å¦‚æœä½ éœ€è¦è¶…è¿‡3å±‚ç¼©è¿›ï¼Œä½ å°±å·²ç»å®Œè›‹äº†"
>
> æ–¹æ¡ˆ2: 1å±‚ç¼©è¿› âœ…
> æ–¹æ¡ˆ1: 3å±‚ç¼©è¿› âŒ

### é£é™©ç‚¹: ä¸€ä¸ª2åˆ†é’Ÿçš„bug

**è‡´å‘½bug**:

```java
// DetSql.java:535
List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
pocTableModel.add(pocLogEntries);  // â† å¦‚æœ pocLogEntries == null?
```

**ä¿®å¤æ–¹æ¡ˆ**:

```java
List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
if (pocLogEntries != null) {
    pocTableModel.add(pocLogEntries);
} else {
    pocTableModel.clear();  // æˆ–è€…æ˜¾ç¤ºå‹å¥½æç¤º
}
```

**ä¸ºä»€ä¹ˆä¼šé—æ¼?**
- ä»£ç ä¸­å·²ç»æœ‰ `if (logEntry.getHttpRequestResponse() != null)` æ£€æŸ¥
- ä½†æ²¡æœ‰ `if (pocLogEntries != null)` æ£€æŸ¥
- **ä¸ä¸€è‡´çš„é˜²å¾¡é£æ ¼** â†’ å®¹æ˜“é—æ¼

**Linus å»ºè®®**:
> "Be consistent in your defensive programming.
>  If you check for null in one place, check everywhere.
>  Otherwise you'll forget one, and that's the one that will bite you."

---

## Linus å¼æ–¹æ¡ˆ

### æ ¸å¿ƒå“²å­¦

> "Talk is cheap. Show me the code."
> â€” Linus Torvalds

**é—®é¢˜æ ¹æº**: å®ç°äº†æ­£ç¡®çš„æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆ2ï¼‰ï¼Œä½†é—æ¼äº†ä¸€ä¸ª null æ£€æŸ¥

**è§£å†³æ–¹æ¡ˆ**: ä¿®å¤ bugï¼Œç„¶åå‘å¸ƒ

### ç«‹å³æ‰§è¡Œï¼ˆä»Šå¤©ï¼‰

**Step 1: ä¿®å¤ç©ºæŒ‡é’ˆbug** (~2åˆ†é’Ÿ)

**ä½ç½®**: `DetSql.java:535`

**å½“å‰ä»£ç **:
```java
String sm3Hash = logEntry.getMyHash();
List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
pocTableModel.add(pocLogEntries);  // â† BUG
```

**ä¿®å¤å**:
```java
String sm3Hash = logEntry.getMyHash();
List<PocLogEntry> pocLogEntries = myHttpHandler.attackMap.get(sm3Hash);
if (pocLogEntries != null) {
    pocTableModel.add(pocLogEntries);
} else {
    pocTableModel.clear();  // æ¸…ç©º Result è¡¨æ ¼
}
```

**Step 2: æµ‹è¯•éªŒè¯** (~10åˆ†é’Ÿ)

```bash
# 1. ç¼–è¯‘
mvn clean compile

# 2. æ‰“åŒ…
mvn clean package -DskipTests

# 3. åœ¨ Burp Suite ä¸­æµ‹è¯•
# - åŠ è½½æ‰©å±•
# - æµ‹è¯•æ— æ¼æ´çš„æ¥å£
# - ç‚¹å‡» DashBoard è¡¨æ ¼
# - éªŒè¯ Result è¡¨æ ¼ä¸ºç©ºï¼ˆä¸å´©æºƒï¼‰
# - ç‚¹å‡»æœ‰æ¼æ´çš„æ¥å£
# - éªŒè¯ Result è¡¨æ ¼æ­£å¸¸æ˜¾ç¤º

# 4. å†…å­˜æµ‹è¯•
# - æµ‹è¯•100ä¸ªæ¥å£ï¼ˆ80æ— æ¼æ´ï¼Œ20æœ‰æ¼æ´ï¼‰
# - ä½¿ç”¨ JProfiler æˆ– VisualVM ç›‘æ§å†…å­˜
# - éªŒè¯å†…å­˜ä» ~57.6MB é™åˆ° ~11.7MB
```

**Step 3: æäº¤ä»£ç ** (~5åˆ†é’Ÿ)

```bash
git add src/main/java/DetSql/DetSql.java
git commit -m "fix: ä¿®å¤æ— æ¼æ´æ¥å£ç‚¹å‡»æ—¶çš„ç©ºæŒ‡é’ˆå¼‚å¸¸

## é—®é¢˜æè¿°
å½“ç”¨æˆ·ç‚¹å‡»æ— æ¼æ´çš„æ¥å£æ—¶ï¼ŒattackMap.get(hash) è¿”å› nullï¼Œ
å¯¼è‡´ pocTableModel.add(null) æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚

## æ ¹æœ¬åŸå› 
æµ‹è¯•å®Œæˆåï¼Œæ— æ¼æ´æ¥å£çš„ attackMap æ¡ç›®è¢«åˆ é™¤ï¼ˆå†…å­˜ä¼˜åŒ–ï¼‰ï¼Œ
ä½† UI ç‚¹å‡»æ—¶æœªæ£€æŸ¥ nullã€‚

## è§£å†³æ–¹æ¡ˆ
æ·»åŠ  null æ£€æŸ¥ï¼š
- å¦‚æœ pocLogEntries != nullï¼Œæ˜¾ç¤ºæµ‹è¯•ç»“æœ
- å¦‚æœ pocLogEntries == nullï¼Œæ¸…ç©º Result è¡¨æ ¼

## å½±å“
- ä¿®å¤å´©æºƒé—®é¢˜
- æå‡ç”¨æˆ·ä½“éªŒï¼ˆé™é»˜å¤±è´¥ï¼‰
- ä¸ httpRequestResponse çš„ null æ£€æŸ¥ä¿æŒä¸€è‡´

å‚è€ƒ: .agent/linus-memory-optimization-verdict.md"

git push origin develop
```

### å¯é€‰ä¼˜åŒ–ï¼ˆä¸‹å‘¨/ä¸‹æœˆï¼‰

**ä¼˜åŒ–1: æ·»åŠ å‹å¥½æç¤º** (~30åˆ†é’Ÿ)

**å½“å‰**: ç‚¹å‡»æ— æ¼æ´æ¥å£ â†’ Result è¡¨æ ¼ä¸ºç©º

**æ”¹è¿›**: ç‚¹å‡»æ— æ¼æ´æ¥å£ â†’ Result è¡¨æ ¼æ˜¾ç¤ºæç¤º

```java
if (pocLogEntries != null) {
    pocTableModel.add(pocLogEntries);
} else {
    // æ˜¾ç¤ºå‹å¥½æç¤º
    pocTableModel.clear();
    // æˆ–è€…æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿçš„ PocLogEntry:
    // pocTableModel.add(Collections.singletonList(
    //     new PocLogEntry("æç¤º", "æ­¤æ¥å£æœªæ£€æµ‹åˆ°æ¼æ´ï¼Œæµ‹è¯•æ•°æ®å·²æ¸…ç†",
    //                     "", "", "", "", "", null, sm3Hash)
    // ));
}
```

**ä¼˜åŒ–2: ç»Ÿè®¡ä¿¡æ¯** (~1å°æ—¶)

**å½“å‰**: æ— ç»Ÿè®¡ä¿¡æ¯

**æ”¹è¿›**: æ˜¾ç¤º "å·²æµ‹è¯•æ¥å£æ•°é‡" å’Œ "æ£€æµ‹åˆ°æ¼æ´æ•°é‡"

```java
// åœ¨ DetSql.java çš„ UI ä¸­æ·»åŠ :
JLabel statsLabel = new JLabel("å·²æµ‹è¯•: 0 | æ¼æ´: 0");

// åœ¨æµ‹è¯•å®Œæˆåæ›´æ–°:
int testedCount = sourceTableModel.log.size();
int vulnCount = sourceTableModel.log.stream()
    .filter(entry -> !entry.getVulnState().isEmpty()
                     && !entry.getVulnState().equals("æ‰‹åŠ¨åœæ­¢"))
    .count();
statsLabel.setText("å·²æµ‹è¯•: " + testedCount + " | æ¼æ´: " + vulnCount);
```

**æ³¨**: è¿™ä¸ªä¼˜åŒ–å·²ç»å®ç°äº†ï¼è§ `DetSql.java:215-223` çš„ `startStatsTimer()` å’Œ `updateStats()`

**ä¼˜åŒ–3: é…ç½®é€‰é¡¹** (~2å°æ—¶ï¼Œä¸æ¨èï¼‰

**å½“å‰**: å¼ºåˆ¶å¯ç”¨å†…å­˜ä¼˜åŒ–

**æ”¹è¿›**: æä¾›é…ç½®é€‰é¡¹è®©ç”¨æˆ·é€‰æ‹©

```java
// Config æ ‡ç­¾é¡µæ·»åŠ :
JCheckBox memoryOptimizationCheck = new JCheckBox("å¯ç”¨å†…å­˜ä¼˜åŒ–ï¼ˆåˆ é™¤æ— æ¼æ´æ•°æ®ï¼‰");

// æµ‹è¯•å®Œæˆå:
if (memoryOptimizationCheck.isSelected() && finalVulnType.isBlank()) {
    attackMap.remove(hash);
}
```

**Linus è¯„ä»·**:
> "Don't add configuration options unless users really need it.
>  Every checkbox is a decision users have to make.
>  Most users don't know what to choose.
>  Make the right choice for them."

**å»ºè®®**: ä¸è¦æ·»åŠ è¿™ä¸ªé€‰é¡¹ï¼Œé»˜è®¤å¯ç”¨å†…å­˜ä¼˜åŒ–å³å¯ã€‚

---

## å®æ–½æ­¥éª¤

### å¦‚æœé€‰æ‹©ç«‹å³ä¿®å¤ï¼ˆæ¨èï¼‰

**1. ä¿®å¤ç©ºæŒ‡é’ˆbug** (~2åˆ†é’Ÿ)
   ```java
   // DetSql.java:535
   if (pocLogEntries != null) {
       pocTableModel.add(pocLogEntries);
   } else {
       pocTableModel.clear();
   }
   ```

**2. æµ‹è¯•éªŒè¯** (~10åˆ†é’Ÿ)
   - æµ‹è¯•æ— æ¼æ´æ¥å£ â†’ éªŒè¯ä¸å´©æºƒ
   - æµ‹è¯•æœ‰æ¼æ´æ¥å£ â†’ éªŒè¯æ­£å¸¸æ˜¾ç¤º
   - å†…å­˜æµ‹è¯• â†’ éªŒè¯èŠ‚çœ ~80%

**3. æäº¤ä»£ç ** (~5åˆ†é’Ÿ)
   ```bash
   git add src/main/java/DetSql/DetSql.java
   git commit -m "fix: ä¿®å¤æ— æ¼æ´æ¥å£ç‚¹å‡»æ—¶çš„ç©ºæŒ‡é’ˆå¼‚å¸¸"
   git push origin develop
   ```

**æ€»è€—æ—¶**: ~17åˆ†é’Ÿ

### å¦‚æœé€‰æ‹©ç­‰å¾…ï¼ˆä¸æ¨èï¼‰

**é£é™©**:
- ç”¨æˆ·å¯èƒ½é‡åˆ°ç©ºæŒ‡é’ˆå¼‚å¸¸
- è°ƒè¯•æ—¶é—´è¿œè¶…ä¿®å¤æ—¶é—´ï¼ˆå¯èƒ½æ•°å°æ—¶ï¼‰
- ç”¨æˆ·ä½“éªŒä¸‹é™

**å»ºè®®**: ç«‹å³ä¿®å¤ï¼Œé£é™©æä½ï¼Œæ”¶ç›Šæé«˜

---

## ä¸å…¶ä»–æ–¹æ¡ˆå¯¹æ¯”

| ç»´åº¦ | å½“å‰æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆ2ï¼‰ | ä¸‰å±‚æ¨¡å‹ï¼ˆæ–¹æ¡ˆ1ï¼‰ | ä¿å®ˆç­–ç•¥ï¼ˆæ–¹æ¡ˆCï¼‰ |
|------|------------------|------------------|------------------|
| **å†…å­˜å ç”¨** | ~11.7MB | ~14MB | ~57.6MB |
| **å®ç°å¤æ‚åº¦** | 18è¡Œï¼ˆå·²å®Œæˆï¼‰ | ~200è¡Œï¼ˆæœªå®ç°ï¼‰ | 0è¡Œï¼ˆå½“å‰çŠ¶æ€ï¼‰ |
| **ç”¨æˆ·ä½“éªŒ** | å¥½ï¼ˆä¸“æ³¨æ¼æ´ï¼‰ | å¥½ï¼ˆä¸“æ³¨æ¼æ´ï¼‰ | å·®ï¼ˆå……æ–¥å™ªéŸ³ï¼‰ |
| **é£é™©** | ä½ï¼ˆ1ä¸ªbugï¼‰ | ä¸­ï¼ˆé‡æ„é£é™©ï¼‰ | ä½ï¼ˆæ— ä¿®æ”¹ï¼‰ |
| **å¯ç»´æŠ¤æ€§** | é«˜ï¼ˆé€»è¾‘ç®€å•ï¼‰ | ä½ï¼ˆä¸‰å±‚å¤æ‚ï¼‰ | ä¸­ï¼ˆæ— ä¼˜åŒ–ï¼‰ |
| **æ•°æ®ä¸€è‡´æ€§** | é«˜ï¼ˆåŒæ­¥åˆ é™¤ï¼‰ | é«˜ï¼ˆè‡ªåŠ¨åŒæ­¥ï¼‰ | ä¸­ï¼ˆæ‰‹åŠ¨åˆ é™¤ï¼‰ |
| **å¯æ‰©å±•æ€§** | ä¸­ï¼ˆå¤Ÿç”¨ï¼‰ | é«˜ï¼ˆè¿‡åº¦ï¼‰ | ä½ï¼ˆéš¾æ‰©å±•ï¼‰ |
| **Linusè¯„åˆ†** | â­â­â­â­â­ | â­â­â­ | â­â­ |

---

## æ¨èæ–¹æ¡ˆ

### çŸ­æœŸ (ä»Šå¤©): ä¿®å¤ç©ºæŒ‡é’ˆbug

**ç†ç”±**:
- å¿«é€Ÿä¿®å¤è‡´å‘½bugï¼ˆ2åˆ†é’Ÿï¼‰
- å†…å­˜ä¼˜åŒ–å·²å®Œæˆï¼ˆ~80% èŠ‚çœï¼‰
- é£é™©å¯æ§ï¼ˆå›æ»šæˆæœ¬ä½ï¼‰

**é€‚ç”¨åœºæ™¯**:
- æ€¥éœ€å‘å¸ƒæ–°ç‰ˆæœ¬
- ç”¨æˆ·å·²ç»é‡åˆ°ç©ºæŒ‡é’ˆå¼‚å¸¸
- å†…å­˜å ç”¨è¿‡é«˜

### é•¿æœŸ (æ°¸è¿œä¸è¦): ä¸è¦é‡æ„ä¸ºä¸‰å±‚æ¨¡å‹

**ç†ç”±**:
- è¿‡åº¦è®¾è®¡ (Overengineering)
- æ”¶ç›Šä¸æ˜æ˜¾ï¼ˆå†…å­˜å ç”¨ç›¸å½“ï¼‰
- è¿å KISS åŸåˆ™

**é€‚ç”¨åœºæ™¯**:
- **æ°¸è¿œä¸é€‚ç”¨**

---

## Linus çš„æœ€ç»ˆå»ºè®®

> "Bad programmers worry about the code. Good programmers worry about data structures and their relationships."
> â€” Linus Torvalds

**å½“å‰é—®é¢˜**: å®ç°äº†æ­£ç¡®çš„æ•°æ®ç»“æ„è®¾è®¡ï¼Œä½†é—æ¼äº†ä¸€ä¸ª null æ£€æŸ¥

**æ­£ç¡®åšæ³•**: ä¿®å¤ bugï¼Œç„¶åå‘å¸ƒ

**å…·ä½“å»ºè®®**:

1. **ç«‹å³ä¿®å¤**: ä½¿ç”¨3è¡Œä»£ç ä¿®å¤ç©ºæŒ‡é’ˆbug
2. **ä¸è¦é‡æ„**: å½“å‰æ–¹æ¡ˆå·²ç»è¶³å¤Ÿå¥½ï¼Œä¸è¦è¿‡åº¦è®¾è®¡
3. **é•¿æœŸç›®æ ‡**: ä¿æŒç®€æ´ï¼Œåªåœ¨çœŸæ­£éœ€è¦æ—¶æ‰å¢åŠ å¤æ‚åº¦

**Linus å¼è¯„ä»·**:

```
å½“å‰æ–¹æ¡ˆ: ğŸŸ¡ å‡‘åˆ â†’ ä¿®å¤å â†’ ğŸŸ¢ å¥½å“å‘³

è‡´å‘½é—®é¢˜:
- ç©ºæŒ‡é’ˆbugï¼ˆ2åˆ†é’Ÿä¿®å¤ï¼‰

æ”¹è¿›æ–¹å‘:
"æ·»åŠ ä¸€ä¸ª if (pocLogEntries != null) æ£€æŸ¥"

è¿™æ ·å†™å‡ºæ¥çš„ä»£ç :
- æ— éœ€åˆ¤æ–­æ•°æ®åœ¨å“ªä¸€å±‚
- æ— éœ€ç®¡ç†å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸ
- æ— éœ€é‡æ„200è¡Œä»£ç 
- GC è‡ªåŠ¨å›æ”¶ï¼ˆå·²å®ç°ï¼‰

"Perfect is the enemy of good.
 Your code is good. Fix the bug and ship it."
```

---

## é™„å½•: å†…å­˜å ç”¨è¯¦ç»†è®¡ç®—

### å‡è®¾åœºæ™¯

- æµ‹è¯•100ä¸ªæ¥å£
- æ¯ä¸ªæ¥å£5ä¸ªå‚æ•°
- 80%æ— æ¼æ´, 20%æœ‰æ¼æ´

### å½“å‰å®ç° (ä¿®å¤å‰)

```
SourceLogEntry:
  - 100 Ã— 1KB = 100KB

PocLogEntry (attackMap):
  - 100 Ã— 5 Ã— 23 Ã— 5KB = 57.5MB

æ€»è®¡: ~57.6MB
```

### ä¿®å¤å (æ–¹æ¡ˆ2)

```
æ— æ¼æ´ (80ä¸ª):
  SourceLogEntry: 80 Ã— 1KB (httpRequestResp=null) = 80KB
  attackMap: 0KB (å·²åˆ é™¤)

æœ‰æ¼æ´ (20ä¸ª):
  SourceLogEntry: 20 Ã— 6KB = 120KB
  attackMap: 20 Ã— 5 Ã— 23 Ã— 5KB = 11.5MB

æ€»è®¡: ~11.7MB
```

**å†…å­˜èŠ‚çœ**: 57.6MB â†’ 11.7MB = **èŠ‚çœ 79.7%**

### ä¸‰å±‚æ¨¡å‹ (æ–¹æ¡ˆ1)

```
ScanResult: 100 Ã— 0.5KB = 50KB
TestMetadata: 100 Ã— 5 Ã— 23 Ã— 0.2KB = 2.3MB
VulnerabilityEvidence: 20 Ã— (6KB + 5Ã—23Ã—5KB) = 11.6MB

æ€»è®¡: ~14MB
```

**å¯¹æ¯”**: 14MB vs 11.7MB = **å¤šå ç”¨ 19.7%**

---

## æ€»ç»“

**æŠ˜ä¸­ç­–ç•¥çš„ä»·å€¼**: åœ¨å†…å­˜å ç”¨å’Œç”¨æˆ·ä½“éªŒä¹‹é—´æ‰¾åˆ°å®Œç¾å¹³è¡¡

**å®æ–½å»ºè®®**:
1. **ç«‹å³**: ä¿®å¤ç©ºæŒ‡é’ˆbugï¼ˆ2åˆ†é’Ÿï¼‰
2. **çŸ­æœŸ**: æ·»åŠ å‹å¥½æç¤ºï¼ˆå¯é€‰ï¼Œ30åˆ†é’Ÿï¼‰
3. **é•¿æœŸ**: **ä¸è¦é‡æ„**ï¼Œå½“å‰æ–¹æ¡ˆå·²ç»è¶³å¤Ÿå¥½

**æ ¸å¿ƒåŸåˆ™**:

> "è¿™10è¡Œå¯ä»¥å˜æˆ3è¡Œ"
> "æ•°æ®ç»“æ„é”™äº†,åº”è¯¥æ˜¯..."
> â€” Linus Torvalds

å½“å‰æ•°æ®ç»“æ„æ˜¯æ­£ç¡®çš„ï¼Œåªéœ€è¦ä¿®å¤ä¸€ä¸ªå°bugã€‚

**æœ€ç»ˆè¯„ä»·**: â­â­â­â­â­ (ä¿®å¤bugå)

---

## ä½œè€…

Linus Torvalds (æ¨¡æ‹Ÿ)

**è¯„ä»·**: è¿™ä¸ªå†…å­˜ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ä¸ªå¥½ä¾‹å­ï¼Œè¯´æ˜äº†**ç®€æ´çš„åŠ›é‡**ã€‚ç”¨18è¡Œä»£ç è§£å†³äº†80%çš„é—®é¢˜ï¼Œè¿™æ¯”ç”¨200è¡Œä»£ç è§£å†³100%çš„é—®é¢˜è¦å¥½å¾—å¤šã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯ä¸€ä¸ª2åˆ†é’Ÿçš„bugï¼Œä¿®å¤å®ƒï¼Œç„¶åå‘å¸ƒã€‚

**å»ºè®®**:
1. ä¿®å¤ç©ºæŒ‡é’ˆbug
2. ä¸è¦é‡æ„ä¸ºä¸‰å±‚æ¨¡å‹
3. ç»§ç»­ä¿æŒç®€æ´çš„ä»£ç é£æ ¼

**æœ€é‡è¦çš„ä¸€å¥è¯**:
> "Keep it simple, stupid. Your code is already good enough."
